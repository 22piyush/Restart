<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <!-- import CSS -->
  <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
</head>
<body>
  <div id="app">
    <el-checkbox v-model="rememberIosData" @change="remeberIosFun">Remember Me</el-checkbox>

    <el-button 
      type="primary" 
      size="default" 
      v-if="showAddButton"
    >
      Add
    </el-button>
  </div>
</body>

<!-- import Vue before Element -->
<script src="https://unpkg.com/vue@2/dist/vue.js"></script>
<script src="https://unpkg.com/element-ui/lib/index.js"></script>
<script>
  new Vue({
    el: '#app',
    data: function() {
      return {
        rememberIosData: false,
        localStorageKeyExists: true // assume true initially
      };
    },

    computed: {
      showAddButton() {
        // Show if checkbox is checked or key doesn't exist
        return this.rememberIosData === true || this.localStorageKeyExists === false;
      }
    },

    mounted() {
      this.syncRememberMe();
      window.addEventListener("storage", this.syncRememberMe);
      window.addEventListener("focus", this.syncRememberMe);
    },

    beforeDestroy() {
      window.removeEventListener("storage", this.syncRememberMe);
      window.removeEventListener("focus", this.syncRememberMe);
    },

    methods: {
      syncRememberMe() {
        const saved = localStorage.getItem("rememberIosData");

        // Update localStorageKeyExists flag
        this.localStorageKeyExists = saved !== null;

        // Sync checkbox state
        this.rememberIosData = saved === "true";
      },

      remeberIosFun() {
        localStorage.setItem("rememberIosData", this.rememberIosData);

        // Update flag after setting
        this.localStorageKeyExists = true;
      }
    }
  });
</script>
</html>
